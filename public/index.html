<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <style>
    body,
    div:first-child {
      margin: 0;
      height: 100vh;
    }
  </style>
</head>

<body>
  <image id="img" style="display: none;"></image>
  <script>
    img.onload = function () { console.log("image!"); }
  </script>
  <main></main>
  <script src="./elm-canvas.js"></script>
  <script src="./elm.js"></script>
  <script>
    var app = Elm.Main.init({ node: document.querySelector("main") });

    app.ports.updateSource.subscribe(function () {
      const c = document.getElementById('initcanvas').children[0];
      c.toBlob(function (blob) {
        // https://stackoverflow.com/a/27737668
        const urlCreator = window.URL || window.webkitURL;
        const blobUrl = urlCreator.createObjectURL(blob);
        app.ports.blobReceiver.send(blobUrl);
      });
    });
  </script>
</body>
<footer>
  <a href="https://github.com/addap/recursive-image-elm">Source: GitHub</a>
</footer>

</html>